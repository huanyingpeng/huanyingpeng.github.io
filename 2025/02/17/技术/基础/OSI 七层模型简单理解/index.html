<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"huanyp.cn","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","display":"post","width_expanded":320,"width_dual_column":240,"padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="本文以现代计算机网络硬件为基础，介绍了现代硬件环境下应该了解的网络知识，能够为网络编程打下一个较好的基础。">
<meta property="og:type" content="article">
<meta property="og:title" content="OSI 七层模型简单理解">
<meta property="og:url" content="http://huanyp.cn/2025/02/17/%E6%8A%80%E6%9C%AF/%E5%9F%BA%E7%A1%80/OSI%20%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3/index.html">
<meta property="og:site_name" content="幻影彭的彩虹">
<meta property="og:description" content="本文以现代计算机网络硬件为基础，介绍了现代硬件环境下应该了解的网络知识，能够为网络编程打下一个较好的基础。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-02-17T15:40:24.000Z">
<meta property="article:modified_time" content="2025-02-22T03:21:18.031Z">
<meta property="article:author" content="huan-yp">
<meta property="article:tag" content="网络">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://huanyp.cn/2025/02/17/%E6%8A%80%E6%9C%AF/%E5%9F%BA%E7%A1%80/OSI%20%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://huanyp.cn/2025/02/17/%E6%8A%80%E6%9C%AF/%E5%9F%BA%E7%A1%80/OSI%20%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3/","path":"2025/02/17/技术/基础/OSI 七层模型简单理解/","title":"OSI 七层模型简单理解"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>OSI 七层模型简单理解 | 幻影彭的彩虹</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">幻影彭的彩虹</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记录青春的扇区</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-友情链接"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友情链接</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%A9%E7%90%86%E5%B1%82"><span class="nav-number">1.</span> <span class="nav-text">物理层</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="nav-number">2.</span> <span class="nav-text">数据链路层</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%95%E4%BD%8D"><span class="nav-number">2.1.</span> <span class="nav-text">数据单位</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%8A%9F%E8%83%BD"><span class="nav-number">2.2.</span> <span class="nav-text">交换机功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mac-%E5%9C%B0%E5%9D%80%E5%AD%A6%E4%B9%A0"><span class="nav-number">2.3.</span> <span class="nav-text">MAC 地址学习</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="nav-number">3.</span> <span class="nav-text">网络层</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ip-%E5%8D%8F%E8%AE%AE"><span class="nav-number">3.1.</span> <span class="nav-text">IP 协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%AC%E7%BD%91-ip-%E5%92%8C%E7%A7%81%E7%BD%91-ip"><span class="nav-number">3.1.1.</span> <span class="nav-text">公网 IP 和私网 IP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ip-%E5%8D%8F%E8%AE%AE%E7%9A%84%E7%89%B9%E7%82%B9"><span class="nav-number">3.1.2.</span> <span class="nav-text">IP 协议的特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ip-%E5%8D%8F%E8%AE%AE%E5%8F%AF%E8%BE%BE%E6%80%A7"><span class="nav-number">3.1.3.</span> <span class="nav-text">IP 协议可达性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86"><span class="nav-number">3.2.</span> <span class="nav-text">子网划分</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81"><span class="nav-number">3.2.1.</span> <span class="nav-text">子网掩码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E7%BD%91%E5%85%B3"><span class="nav-number">3.2.2.</span> <span class="nav-text">默认网关</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1"><span class="nav-number">3.3.</span> <span class="nav-text">路由</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#arp-%E5%8D%8F%E8%AE%AE"><span class="nav-number">3.3.1.</span> <span class="nav-text">ARP 协议</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8"><span class="nav-number">3.3.2.</span> <span class="nav-text">路由器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#arp-%E5%8D%8F%E8%AE%AE%E5%9C%A8%E8%B7%AF%E7%94%B1%E5%99%A8%E4%B8%8A%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-number">3.3.3.</span> <span class="nav-text">ARP 协议在路由器上的实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E8%A1%A8"><span class="nav-number">3.3.4.</span> <span class="nav-text">路由表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%8E%B0%E4%BB%A3%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8"><span class="nav-number">3.3.5.</span> <span class="nav-text">现代无线路由器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E4%B8%AA%E7%A4%BA%E4%BE%8B"><span class="nav-number">3.3.6.</span> <span class="nav-text">一个示例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#nat"><span class="nav-number">3.4.</span> <span class="nav-text">NAT</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#nat-%E8%83%BD%E5%B9%B2%E4%BB%80%E4%B9%88"><span class="nav-number">3.4.1.</span> <span class="nav-text">NAT 能干什么</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nat-%E6%80%8E%E4%B9%88%E5%B8%83%E7%BD%AE"><span class="nav-number">3.4.2.</span> <span class="nav-text">NAT 怎么布置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nat-%E7%9A%84%E5%88%86%E7%B1%BB%E5%92%8C%E5%8E%9F%E7%90%86"><span class="nav-number">3.4.3.</span> <span class="nav-text">NAT 的分类和原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nat-%E7%A9%BF%E9%80%8F"><span class="nav-number">3.4.4.</span> <span class="nav-text">NAT 穿透</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ap-%E9%9A%94%E7%A6%BB"><span class="nav-number">3.5.</span> <span class="nav-text">AP 隔离</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%88%E4%B8%80%E4%B8%AA%E7%A4%BA%E4%BE%8B"><span class="nav-number">3.6.</span> <span class="nav-text">又一个示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%B2%E8%AF%9D"><span class="nav-number">3.7.</span> <span class="nav-text">闲话</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82"><span class="nav-number">4.</span> <span class="nav-text">传输层</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#udp-%E5%8D%8F%E8%AE%AE"><span class="nav-number">4.1.</span> <span class="nav-text">UDP 协议</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tcp-%E5%8D%8F%E8%AE%AE"><span class="nav-number">4.2.</span> <span class="nav-text">TCP 协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6"><span class="nav-number">4.2.1.</span> <span class="nav-text">连接管理机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E6%9C%BA%E5%88%B6"><span class="nav-number">4.2.2.</span> <span class="nav-text">数据传输机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6%E6%9C%BA%E5%88%B6"><span class="nav-number">4.2.3.</span> <span class="nav-text">拥塞控制机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E5%85%B3%E9%97%AD%E6%9C%BA%E5%88%B6"><span class="nav-number">4.2.4.</span> <span class="nav-text">连接关闭机制</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D%E5%B1%82"><span class="nav-number">5.</span> <span class="nav-text">会话层</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D%E7%9A%84%E5%BB%BA%E7%AB%8B"><span class="nav-number">5.1.</span> <span class="nav-text">会话的建立</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86"><span class="nav-number">5.2.</span> <span class="nav-text">会话管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D%E7%BB%88%E6%AD%A2"><span class="nav-number">5.3.</span> <span class="nav-text">会话终止</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D%E5%B1%82%E4%B8%8E%E4%BC%A0%E8%BE%93%E5%B1%82%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">5.4.</span> <span class="nav-text">会话层与传输层的区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A8%E7%A4%BA%E5%B1%82"><span class="nav-number">6.</span> <span class="nav-text">表示层</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82"><span class="nav-number">7.</span> <span class="nav-text">应用层</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#dns-%E5%8D%8F%E8%AE%AE"><span class="nav-number">7.1.</span> <span class="nav-text">DNS 协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="nav-number">7.1.1.</span> <span class="nav-text">工作过程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#http-%E5%8D%8F%E8%AE%AE"><span class="nav-number">7.2.</span> <span class="nav-text">HTTP 协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD"><span class="nav-number">7.2.1.</span> <span class="nav-text">主要功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%8F%E8%AE%AE%E7%89%B9%E7%82%B9"><span class="nav-number">7.2.2.</span> <span class="nav-text">协议特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%8F%E8%AE%AE%E7%89%88%E6%9C%AC"><span class="nav-number">7.2.3.</span> <span class="nav-text">协议版本</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#https-%E5%8D%8F%E8%AE%AE"><span class="nav-number">7.3.</span> <span class="nav-text">HTTPS 协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%A0%E4%B8%AA%E7%BC%96%E7%A8%8B%E7%BB%86%E8%8A%82%E7%9A%84%E6%8F%90%E9%86%92"><span class="nav-number">7.3.1.</span> <span class="nav-text">几个编程细节的提醒</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tlsssl-%E5%8D%8F%E8%AE%AE"><span class="nav-number">7.4.</span> <span class="nav-text">TLS&#x2F;SSL 协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%81%E4%B9%A6%E9%93%BE%E9%AA%8C%E8%AF%81%E6%9C%BA%E5%88%B6"><span class="nav-number">7.4.1.</span> <span class="nav-text">证书链验证机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ssl-%E6%8F%A1%E6%89%8B%E8%BF%87%E7%A8%8B"><span class="nav-number">7.4.2.</span> <span class="nav-text">SSL 握手过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tls-%E5%8D%8F%E8%AE%AE"><span class="nav-number">7.4.3.</span> <span class="nav-text">TLS 协议</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%90%E9%86%92"><span class="nav-number">8.</span> <span class="nav-text">提醒</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="huan-yp"
      src="https://cdn.luogu.com.cn/upload/image_hosting/kvac64s4.png">
  <p class="site-author-name" itemprop="name">huan-yp</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">105</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">47</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/huan-yp" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;huan-yp" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:3051561876@qq.com" title="E-Mail → mailto:3051561876@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/1155409006?spm_id_from=333.1369.0.0" title="Bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;1155409006?spm_id_from&#x3D;333.1369.0.0" rel="noopener me" target="_blank"><i class="fab fa-youtube fa-fw"></i>Bilibili</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://huanyp.cn/2025/02/17/%E6%8A%80%E6%9C%AF/%E5%9F%BA%E7%A1%80/OSI%20%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/image_hosting/kvac64s4.png">
      <meta itemprop="name" content="huan-yp">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="幻影彭的彩虹">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="OSI 七层模型简单理解 | 幻影彭的彩虹">
      <meta itemprop="description" content="本文以现代计算机网络硬件为基础，介绍了现代硬件环境下应该了解的网络知识，能够为网络编程打下一个较好的基础。">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          OSI 七层模型简单理解
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-02-17 23:40:24" itemprop="dateCreated datePublished" datetime="2025-02-17T23:40:24+08:00">2025-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-02-22 11:21:18" itemprop="dateModified" datetime="2025-02-22T11:21:18+08:00">2025-02-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
        </span>
    </span>

  
</div>

            <div class="post-description">本文以现代计算机网络硬件为基础，介绍了现代硬件环境下应该了解的网络知识，能够为网络编程打下一个较好的基础。</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>这篇文章是以<strong>现代计算机网络硬件</strong>为基础编写的，主要介绍了现代硬件环境下应该了解的网络知识，能够为网络编程打下一个较好的基础。</p>
<p>第一次接触不一定能理解全部内容，但当你对网络编程有一定了解后，也可以回来再看看？</p>
<h2 id="物理层">物理层</h2>
<ul>
<li><p>这一层是电子信息系的事，不是计算机系的事。</p></li>
<li><p>这一层可以实现在<strong>两台设备间不稳定的传输数据</strong>。</p></li>
<li><p>这一层数据传输的基本单位是 bit。</p></li>
</ul>
<h2 id="数据链路层">数据链路层</h2>
<p>这一层的主要设备是交换机。</p>
<p>多台主机和交换机，网线构成了一个 LAN。</p>
<h3 id="数据单位">数据单位</h3>
<p>数据层的数据传输单位是 Frame
(帧)，帧包括帧头，帧体，帧尾，帧头包括数据 src 和 dst 的 MAC
地址，帧尾包含一些校验信息。</p>
<p>数据链路层保证了 LAN 中数据传输的可靠性。</p>
<p>以其中一种机制为例：</p>
<ul>
<li>发送方在发送帧的时候，会等待一个 ACK 确认，如果没有等到 ACK
确认，则会重传该帧，直到所有数据帧得到 ACK 确认时结束传输。</li>
<li>接收方会根据帧尾的校验信息确认帧体数据无误，无误后发送 ACK
确认。</li>
</ul>
<h3 id="交换机功能">交换机功能</h3>
<p>数据链路层中，每台设备具有唯一 MAC
地址（这是出厂时烧在网卡上的唯一标识）。</p>
<p>交换机主要用于根据数据帧的 MAC 地址在主机间正确转发数据帧。</p>
<h3 id="mac-地址学习">MAC 地址学习</h3>
<p>交换机有若干个口可以插，如果可能，交换机收到数据后，只会往目标 MAC
的那个端口发。</p>
<p>如果交换机没记录目标 MAC 的端口，则会进行依次广播，根据 ACK
机制，在目标计算机回传 ACK 包时，记录这条信息，并将 MAC 对应上。</p>
<p>这是大部分交换机采用的策略。</p>
<p>当然，有更加复杂的机制来处理诸如 "把 1 口的线转插到 2 口"
这种事。</p>
<p>一个端口能对应多个 MAC
地址，所以你把交换机和交换机插在一起，也能正常组网。</p>
<h2 id="网络层">网络层</h2>
<p>网络层的主要设备是<strong>路由器（Router）</strong>，主要协议是
<strong>IP 协议</strong>。</p>
<p>数据链路层组网完毕后，形成一个 LAN，通过路由器，可以将若干个 LAN
连接成一个更大的 LAN。</p>
<p>我们说的 Internet，就是一个世界范围的 LAN。</p>
<p><em>MAN、WAN 本质都是 LAN，只是规模不同。</em></p>
<h3 id="ip-协议">IP 协议</h3>
<h4 id="公网-ip-和私网-ip">公网 IP 和私网 IP</h4>
<p>公网IP地址（Public IP
Address）是指在全球互联网范围内可以直接访问的IP地址。这些地址是<strong>唯一</strong>的。</p>
<p>众所周知，公网 IP 是从 <code>0.0.0.0</code> 到
<code>255.255.255.255</code>
的，其中有三段不会被分配，可以用于建立<strong>子网</strong>：</p>
<ul>
<li><code>10.0.0.0 - 10.255.255.255</code>，又记作
<code>10.0.0.0/8</code>。</li>
<li><code>172.16.0.0 - 172.31.255.255</code>，又记作
<code>172.16.0.0/12</code>。</li>
<li><code>192.168.0.0 - 192.168.255.255</code>，又记作
<code>192.168.0.0/16</code>。</li>
</ul>
<p><em>后面那个数字指<strong>前缀长度</strong>。</em></p>
<p>一般的电脑是没有公网 IP 的，所以不能直接在互联网上被访问。</p>
<p>但是你能 <code>ipconfig/ifconfig</code> 出来一个 IP
地址，注意观察的话：</p>
<ul>
<li><p>以你车的校园网为例，它采用了 <code>10.0.0.0/8</code>
这个区段，大概能支持 <span class="math inline">\(1.6\times10^7\)</span>
个设备，对你车来说是够用了。</p></li>
<li><p>以你家的无线网为例，它采用了 <code>192.168.0.0/16</code>
这个区段，大概能支持 <span class="math inline">\(6.5\times 10^4\)</span>
个设备，对你家来说是够用了。</p></li>
</ul>
<h4 id="ip-协议的特点">IP 协议的特点</h4>
<ul>
<li><strong>无连接</strong>：IP协议是无连接的，即它不需要在发送数据前建立连接。给个
IP 地址，IP 协议就能尝试去把数据发过去。</li>
<li><strong>尽力而为的传输</strong>：IP协议只负责将数据报发送到目的地，但不保证数据的顺序、完整性或可靠性。数据丢失、重复或乱序需要由上层协议处理。</li>
</ul>
<h4 id="ip-协议可达性">IP 协议可达性</h4>
<p>两台机子能够<strong>使用 IP 协议相互通信</strong>当且仅当：</p>
<ul>
<li>两台机子处于同一子网下</li>
<li>两台机子都拥有公网 IP。</li>
</ul>
<p>没有特殊说明，后面的讨论中，默认是以上两种情况。</p>
<p><em>注意这里的限定，平时你的机子和百度通信，你是没有公网 IP
的，和百度也不在一个子网下，这个时候你们就不是用 IP
协议直接通信的，而是有更复杂的机制。</em></p>
<h3 id="子网划分">子网划分</h3>
<p>实际应用过程中，会对子网做更细一步的划分。</p>
<p>不过要注意，在<strong>第一次的划分</strong>中，所有的 IPV4
地址被保留了三段作为私有地址，这三段私有地址可以被多个子网使用。</p>
<p>也就是说，在整个 Internet 中，可以有多个子网 S1, S2,
S3....，它们都使用同一段私有地址。（例如你家和小明家宽带都用的
<code>192.168.0.0(16)</code> 这一段）</p>
<p>但是，对子网的下一步划分，就无法多次使用同一段了，这个层次的划分局限于<strong>将子网的私有地址分成若干块，每一个小子网得到一块。</strong>不同的小子网无法使用同一个
IP。</p>
<p>当然，小子网可以继续做划分。</p>
<p>最后，有一个子网中的所有设备都被数据链路层（交换机和以太网线）连接起来了，如果两台设备处于这样一个子网中，我们称这两个设备<strong>相邻</strong>。有时候<strong>相邻</strong>会和<strong>处于同一子网中</strong>混淆。</p>
<h4 id="子网掩码">子网掩码</h4>
<p>子网掩码用于判断两个 IP 地址是否处于同一个子网（不是指相邻）。</p>
<p>上文介绍了一个复杂的子网划分机制，子网掩码用于判断两个 IP
地址是否处于同一子网。</p>
<p>例如，有子网 A，B，C，其中 B，C 是 A 子网划分出来的两个子网，其中</p>
<ul>
<li>A
<ul>
<li>IP 段：<code>192.168.0.0/16</code></li>
<li>子网掩码：<code>255.255.0.0</code></li>
</ul></li>
<li>B
<ul>
<li>IP 段：<code>192.168.1.0/24</code></li>
<li>子网掩码：<code>255.255.255.0</code></li>
</ul></li>
<li>C
<ul>
<li>IP 段：<code>192.168.2.0/24</code></li>
<li>子网掩码：<code>255.255.255.0</code></li>
</ul></li>
</ul>
<p>那么，对于
M1：<code>192.168.2.16</code>，M2：<code>192.168.1.16</code>，M3：<code>192.168.1.17</code>
三台机器来说，在子网 A 处，M1，M2，M3 处于同一子网，但在子网 B，C 处，M1
和 M2 不处于同一子网。</p>
<p>一般的子网掩码的低若干位是 0，IP
和子网掩码<strong>按位与</strong>，结果相同则处于同一子网。</p>
<p>主机发送数据包时，根据目标 IP
地址和子网掩码计算是否处于同一子网，如果处于同一子网，则直接走<strong>数据链路层</strong>发送过去。</p>
<h4 id="默认网关">默认网关</h4>
<p>一个子网一般只有一个默认网关，这个默认网关一般就是路由器，路由器的有关知识会在下一部分讲到。</p>
<p>如果你用 "网络属性" 去看过 IPV4
地址协议，就会看到这个选项是和子网掩码在一起的。</p>
<ul>
<li>默认网关和路由器：路由器负责处理不同子网之间的通信，它的每个槽接入的是不同的子网。如果
IP 协议发送的数据的目标 IP
不在同一子网，则会发往默认网关，默认网关再来处理这个数据，将它发往正确的地方。</li>
<li>自动 DHCP：现在一般不用手动去设置默认网关、IP
地址、子网掩码，都是采用 "自动DHCP" 方式自动分配。</li>
</ul>
<h3 id="路由">路由</h3>
<h4 id="arp-协议">ARP 协议</h4>
<p><strong>ARP
协议的工作范围是子网</strong>，以下场景均发生在同一子网内。</p>
<p>ARP 协议是介于数据链路层和网络层之间的协议，用于通过 IP 地址查询 MAC
地址。</p>
<p>IP 协议的数据包是对数据链路层的数据包外面包了一个，但是有个问题。IP
协议的标准是：知道 IP 就能尝试发过去。但是数据链路层的包里是需要包括 MAC
地址的，那我不知道 MAC 地址怎么办？</p>
<p>这个时候需要 ARP 发挥作用，在不知道 MAC 地址时，主机会发送一次 ARP
<strong>广播</strong>，查询目标 IP 对应的 MAC
地址，目标主机收到查询后（查询中包含源主机的
MAC），会向源主机发送一次回复，源主机得到对应的 MAC 地址。</p>
<p><em>交换机如何处理 ARP 广播：广播类消息的 MAC
会设置为<strong>泛洪帧</strong>，即<code>FF:FF:FF:FF:FF:FF</code>），交换机会将该帧从除接收端口以外的所有端口发送出去，以便局域网内的所有设备都能收到。</em></p>
<h4 id="路由器">路由器</h4>
<p>IP
协议的关键是可以在不同子网中通信，路由器是实现不同子网通信的关键设备。一个子网要和其它子网连接，则必须为子网配置路由器。</p>
<p>一般来说，一个路由器会属于两个以上的子网，可以成为多个子网的默认网关。</p>
<p><strong>路由器拥有一个 IP 地址，路由器的每个插槽有一个独立的 MAC
地址。</strong></p>
<h4 id="arp-协议在路由器上的实现">ARP 协议在路由器上的实现</h4>
<ul>
<li><p>为什么 ARP 的工作范围是子网？</p>
<p>进行 ARP 广播时，如果 IP 不在该子网内，路由器会返回接入该子网端口的
MAC。</p>
<p>这样会为子网中的设备提供一个数据链路层的假象：所有的子网外设备的 MAC
地址均是网关设备的 MAC，这个假象会对网络系统的设计带来巨大的便利。</p>
<p><em>这里 IP
是否在子网内是由默认网关（路由器判断的），因此，默认网关也需要配置子网掩码。</em></p></li>
<li><p>这样搞不会导致数据包到了目标子网后 MAC 出错吗？</p>
<p>MAC 在数据链路层中发挥作用，也就是说 MAC
地址仅仅负责一个子网中的通信。数据经过默认网关（路由器）发向其它子网时，会改动数据中的
MAC 地址，将其改为发送槽的 MAC。</p>
<p>不妨假设两个子网的路由器位于同一子网，这样可以将数据包准确的发送到对应子网（路由器处）去，路由器再通过
ARP 协议查询子网中对应 IP 的 MAC 并修改然后发过去。</p></li>
</ul>
<h4 id="路由表">路由表</h4>
<blockquote>
<p>"路由" 是指数据包从源设备到目标设备传输路径选择的过程</p>
</blockquote>
<p>子网外的数据发到路由器后，路由器需要选择一个端口发过去。可能有很多种从子网
S1 到子网 S2
的路径，路由的作用就是去选择一条<strong>最好</strong>的路径。</p>
<p>路由器通过路由表查找最佳的端口选择，路由表并不是一张表，而是一组策略的集合，通过路由表中的策略和目标
IP 来确定数据走哪个端口。</p>
<p>路由的方式主要有三种：</p>
<ul>
<li>直连路由：和路由器直接连接的其它路由器与路由器所在的（若干个）子网存在直接路由，也就是可以直接找到这些对象的
IP 地址。</li>
<li>静态路由：人工配置的 IP/IP段 应该走的端口。</li>
<li>动态路由：路由器之间通过一些算法交换自己的直连路由信息，动态构建路由表。</li>
<li>默认路由：以上规则失效时，走一个默认的端口（通常指向上级路由器，常见于家庭路由器）</li>
</ul>
<p>我们接触和使用的路由器网络很简单，仅通过动态路由的方式就能完美实现局部的路由。</p>
<p><em>网络服务商所用的路由器连接结构非常复杂，要处理广域的 IP
路由，往往需要大型计算机的支持。</em></p>
<h4 id="现代无线路由器">现代无线路由器</h4>
<p>现代无线路由器有<strong>自组网</strong>的功能。</p>
<p>路由器的几个端口同时也具备交换机的功能，它一般能自动判断一个插槽到底接入的是一个子网还是一个数据链路层对象，如果是后者，这个插槽将发挥交换机的作用。</p>
<h4 id="一个示例">一个示例</h4>
<p>网络拓扑结构如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">子网1：192.168.1.0/24  </span><br><span class="line">        |  </span><br><span class="line">[路由器]（接口1：192.168.1.1，接口2：192.168.2.1）  </span><br><span class="line">        |  </span><br><span class="line">子网2：192.168.2.0/24  </span><br><span class="line"></span><br><span class="line">子网1设备：  </span><br><span class="line">- 交换机1（无需IP）  </span><br><span class="line">  - PC1：192.168.1.10/24，网关192.168.1.1  </span><br><span class="line">  - PC2：192.168.1.20/24，网关192.168.1.1  </span><br><span class="line"></span><br><span class="line">子网2设备：  </span><br><span class="line">- 交换机2（无需IP）  </span><br><span class="line">  - PC3：192.168.2.10/24，网关192.168.2.1  </span><br><span class="line">  - PC4：192.168.2.20/24，网关192.168.2.1  </span><br></pre></td></tr></table></figure>
<ol type="1">
<li><strong>路由器</strong>
<ul>
<li>接口1（连接子网1）：IP <code>192.168.1.1</code>，子网掩码
<code>255.255.255.0</code>。</li>
<li>接口2（连接子网2）：IP <code>192.168.2.1</code>，子网掩码
<code>255.255.255.0</code>。</li>
<li>路由表自动包含直连网络 <code>192.168.1.0/24</code> 和
<code>192.168.2.0/24</code>。</li>
</ul></li>
<li><strong>交换机1和交换机2</strong>
<ul>
<li>仅作为二层设备，根据MAC地址转发数据帧，无需配置IP。</li>
</ul></li>
<li><strong>终端设备</strong>
<ul>
<li>PC1/PC2的子网掩码为 <code>255.255.255.0</code>，网关指向路由器的
<code>192.168.1.1</code>。</li>
<li>PC3/PC4的子网掩码为 <code>255.255.255.0</code>，网关指向路由器的
<code>192.168.2.1</code>。</li>
</ul></li>
</ol>
<p>PC1 到 PC3 的通信示例如下：</p>
<ol type="1">
<li><strong>判断目标子网</strong>
PC1（<code>192.168.1.10</code>）检查目标IP
<code>192.168.2.10</code>，发现不在同一子网（通过子网掩码计算）。</li>
<li><strong>发送到默认网关</strong>
<ul>
<li>PC1将数据包的目标MAC地址设置为路由器接口1的MAC地址（通过ARP协议获取）。</li>
<li>数据包通过交换机1转发到路由器的接口1。</li>
</ul></li>
<li><strong>路由器处理</strong>
<ul>
<li>路由器解封装数据包，检查目标IP <code>192.168.2.10</code>
和路由表，发现属于直连子网2。</li>
<li>将数据包从接口2（<code>192.168.2.1</code>）转发到子网2。</li>
</ul></li>
<li><strong>子网2内传输</strong>
<ul>
<li>路由器通过 ARP 获取 PC3 的 MAC 地址（若缓存中无记录）。</li>
<li>数据包目标 MAC 改为 PC3 的 MAC，通过交换机2转发到PC3。</li>
</ul></li>
<li><strong>响应返回</strong> PC3
的响应数据包反向执行相同流程，通过路由器回到 PC1。</li>
</ol>
<h3 id="nat">NAT</h3>
<p>本科期间任何一本教科书都不会教你 NAT 相关的知识，但现在这个年头不懂
NAT 是很难做好网络编程的。</p>
<h4 id="nat-能干什么">NAT 能干什么</h4>
<ul>
<li><p><strong>地址转换</strong>：</p>
<p>NAT 设备的主要功能是将一个 IP
地址空间中的地址转换为另一个地址空间中的地址。例如，它可以把私有IP地址（如192.168.x.x）转换为公网IP地址，或者将公网
IP 地址转换为私有 IP 地址。</p>
<ul>
<li>这个操作常用于让子网中没有公网 IP
的设备能够访问公网。例如，你的计算机通过通信服务商的 NAT
设备访问各种公网网站。</li>
<li>也可以用于进一步拓展子网可用 IP，例如通过保留私有 IP
组了一个公网下的一级子网，一级子网向你的二级子网分配了少量 IP
地址，然后你发现这些 IP 地址不够用，于是可以在你的二级子网配置一个 NAT
设备，二级子网内部采用更大的地址空间，和一级子网通信时采用 NAT
，就像一级子网和公网通信那样。这种 NAT 也被称为<strong>多层
NAT</strong>。</li>
</ul></li>
<li><p><strong>隐藏内部网络</strong>：</p>
<p>NAT 可以隐藏内部网络的拓扑结构和设备 IP 地址，增强网络的安全性。</p>
<p>事实上你裸奔的电脑没遭到黑客的攻击就是 NAT 在默默守护。</p></li>
</ul>
<h4 id="nat-怎么布置">NAT 怎么布置</h4>
<p>NAT
设备一般布置在<strong>出口网关</strong>处（其实出口网关大部分时候是默认网关），NAT
发挥地址转换作用</p>
<h4 id="nat-的分类和原理">NAT 的分类和原理</h4>
<p>NAT 主要有三种：</p>
<ol type="1">
<li><p><strong>静态 NAT（Static NAT）</strong></p>
<p><strong>原理</strong>：将内部网络中的每个私网 IP 地址与一个固定的公网
IP
地址进行一对一的映射。这种映射关系是预先配置好的，不会随着时间或网络连接的变化而改变。</p></li>
<li><p><strong>动态 NAT（Dynamic NAT）</strong></p>
<p><strong>原理</strong>：将内部私网 IP 地址动态地映射到一组公网 IP
地址池中的地址。当内部设备有访问外部网络的需求时，NAT 设备从公网 IP
地址池中选择一个可用的公网 IP
地址，并建立私网地址和公网地址的映射关系。这种映射关系在一定时间内有效，当连接结束或超时后，映射关系被释放，公网
IP 地址可以重新分配给其他内部设备。</p></li>
<li><p><strong>PAT（Port Address
Translation，端口地址转换）</strong></p>
<p><strong>原理</strong>：允许多个内网设备共享一个公网 IP
地址，通过不同的端口号来区分不同的内网设备。当内网设备发送数据到外网时，NAT
设备会将数据包的源 IP 地址转换为公网 IP
地址，并分配一个未使用的端口号。返回的数据包通过端口号来确定目标内网设备。它是<strong>日常中最常见的
NAT 方式</strong>，有效地解决了 IPv4
地址不足的问题，适用于家庭和小型企业网络。</p></li>
</ol>
<h4 id="nat-穿透">NAT 穿透</h4>
<p>NAT 很好，但是有时候你期望你的电脑能够在公网上被访问。（例如开 MC
服务器时）</p>
<p>由于你的电脑并没有公网 IP，所有的网络通信都是通过 NAT
完成的，所以你的电脑无法被外部直接访问，这时候我们就需要 NAT
穿透来完成<strong>间接</strong>访问。</p>
<ul>
<li><p>Q：我用 IP 工具可以查到我电脑公网 IP 呀？为什么不能用这个
IP。</p></li>
<li><p>A：首先这个 IP
是动态分配的，随时可能会变，其次<strong>运营商有运营商的安全考虑，不允许外部通过
NAT 开放的端口主动建立连接。</strong></p>
<p><em>你打游戏时看上去是服务器向你请求数据，实际上这个过程是会话层实现的，主动建立会话的是你。</em></p></li>
</ul>
<p>以下是常用的 NAT 穿透的方法：</p>
<ul>
<li>内网穿透：一般情况这是唯一能用的方法。</li>
<li>UDP/TCP 打洞：一般用不了。</li>
</ul>
<h3 id="ap-隔离">AP 隔离</h3>
<p>有时候不希望同一子网的设备能够相互访问，这个时候可以开启 AP
隔离。</p>
<p>AP
隔离在<strong>数据链路层</strong>上丢弃访问子网内设备相互访问的数据包（与默认网关的除外），来禁止子网设备相互访问。</p>
<p>一般来说，AP 隔离是在<strong>无线路由器</strong>上开启的，但是 AP
隔离是一个<strong>数据链路层</strong>的操作，为什么会这样呢？</p>
<p>我们前面提到了现代无线路由器其实既是网络层设备，又是数据链路层设备和物理层设备，所以一般会在这里操作。</p>
<p>因此，如果两台计算机在子网中直接用物理层设备连接（以太网线），这种 AP
隔离是不生效的。</p>
<h3 id="又一个示例">又一个示例</h3>
<p>你车的计算机楼开启了 AP
隔离，计算机楼的设备之间无法通过内网相互通信。</p>
<p>但你车校园网整体是一个子网，计算机楼是进一步划分的子网，宿舍楼开的服务器不在计算楼子网内，没有开启
AP 隔离，可以通过子网访问。</p>
<p>所以出现了：计算机楼可以访问宿舍楼的服务器，但是别的地方无法访问计算机楼的服务器。</p>
<p><del>事实上这个问题在帆软杯的时候出现过，我们把服务器搬到宿舍楼后就能正常访问了。</del></p>
<h3 id="闲话">闲话</h3>
<ul>
<li>路由器和交换机都很便宜，几十块钱就能买一个，网线就更便宜了，可以试着自己买点回来组网。</li>
<li>网络层是 OSI 七层中最复杂的一层，后面没有这么难了。</li>
<li>校园网这个环境特别适合开展网络实践，可以多自己动手试一试。</li>
</ul>
<h2 id="传输层">传输层</h2>
<p>传输层的主要目的是在源节点和目的节点的<strong>应用程序</strong>之间建立、维护和终止端到端的通信连接。</p>
<p>平日用到的<strong>端口</strong>，就是传输层的概念。</p>
<h3 id="udp-协议">UDP 协议</h3>
<p>UDP
协议是一种无连接的、不可靠的、基于数据报的传输层协议。它在数据传输前不需要建立连接，传输效率较高，但不提供可靠的数据传输保证，适用于对实时性要求较高但对数据丢失不太敏感的应用，如视频直播、在线游戏、DNS
查询等。</p>
<p>它和 IP 协议的区别就是它支持端口（port）号了，而 IP
协议的传输中不涉及端口。</p>
<p>UDP 协议本质就是在 IP 协议数据包再简单套了 UDP
头部，包含端口信息。</p>
<h3 id="tcp-协议">TCP 协议</h3>
<p>TCP
协议是一种面向连接的、可靠的、基于字节流的传输层协议。它在数据传输前需要建立连接，传输过程中提供可靠的数据传输和流量控制等服务，适用于对数据传输可靠性要求较高的应用。</p>
<p>下面是老生常谈的三次握手和四次挥手。</p>
<h4 id="连接管理机制">连接管理机制</h4>
<ul>
<li><strong>第一次握手</strong> ：客户端向服务器端发送一个包含 SYN
标志位的 TCP 段，请求建立连接。</li>
<li><strong>第二次握手</strong> ：服务器端收到客户端的 SYN
包后，如果同意建立连接，就发送一个包含 SYN 和 ACK 标志位的 TCP
段作为回应，其中 ACK 对客户端的 SYN 进行确认，同时发送自己的 SYN
来请求客户端对自己的连接进行确认。</li>
<li><strong>第三次握手</strong> ：客户端收到服务器端的 SYN + ACK
后，再发送一个 ACK 包作为确认，从而完成三次握手过程，建立起可靠的 TCP
连接。</li>
</ul>
<h4 id="数据传输机制">数据传输机制</h4>
<ul>
<li><strong>可靠传输</strong> ：采用
“确认应答机制”（ACK），发送方在发送完数据后，会等待接收方的确认应答信号。如果在规定的时间内没有收到确认应答，发送方会重新发送数据。</li>
<li><strong>按序传输</strong>
：发送方将数据分割成多个小的分组（数据段），为每个数据段分配一个唯一的序列号，接收方根据序列号重新组装接收到的分组，确保数据按照正确的顺序传输。</li>
<li><strong>流量控制</strong>
：通过滑动窗口机制来控制数据的传输速率。发送方会维护一个发送窗口，表示可以连续发送而无需等待应答的字节的数量。接收方则通过通知窗口的大小（窗口通告）来告知发送方当前的接收能力，发送方根据接收方的通告调整发送窗口的大小，避免发送过快导致接收方无法处理而丢弃数据，从而实现流量控制。</li>
</ul>
<h4 id="拥塞控制机制">拥塞控制机制</h4>
<ul>
<li><strong>慢启动</strong>
：在一开始的时候，发送方将发送窗口的大小设置为一个较小的数值（由慢启动门限值决定），然后随着每收到一个确认应答增量增加发送窗口，以快速探测网络能够支持的传输速率。</li>
<li><strong>拥塞避免</strong>
：当发送窗口增加到慢启动门限值时，改为按线性规律缓慢增加发送窗口，即每次收到一个确认应答时，以加法的方式（如每次增加
1
个基本单位）增大发送窗口，使得网络处于一种比较平稳的状态，防止网络拥塞突然发生。</li>
<li><strong>快重传</strong>
：当发送方连续收到三个重复的确认应答（接收方通过发送重复的 ACK
来告知中间某个数据段已经丢失），就立即重传对方尚未收到的数据段，而不是等待超时定时器溢出，这样可以快速恢复通信过程。</li>
<li><strong>快恢复</strong>
：在执行快重传后，发送方假设网络现在有一些拥塞，因此需要将慢启动门限值减少到当前发送窗口大小的一半，并且将发送窗口设置为慢启动门限值，然后进入拥塞避免阶段，按照拥塞避免的机制来逐步增加发送窗口。</li>
</ul>
<h4 id="连接关闭机制">连接关闭机制</h4>
<ul>
<li><strong>第一次挥手</strong>
：客户端主动发起关闭连接请求，向服务器端发送一个包含 FIN 标志位的 TCP
段。</li>
<li><strong>第二次挥手</strong> ：服务器收到 FIN
后，向客户端发送一个包含 ACK 标志位的 TCP
段作为确认，通知客户端已收到关闭请求。</li>
<li><strong>第三次挥手</strong>
：服务器端处理完需要完成的任务后，向客户端发送一个包含 FIN 和 ACK
标志位的 TCP 段，请求关闭连接。</li>
<li><strong>第四次挥手</strong> ：客户端收到服务器端的 FIN + ACK
后，再发送一个 ACK 包作为确认，完成四次挥手过程，正式关闭 TCP
连接。</li>
</ul>
<h2 id="会话层">会话层</h2>
<p>会话层的主要功能是建立、维护和终止两个通信系统之间的会话连接。它负责管理会话的生命周期，包括会话的建立、数据传输过程中的会话管理和会话的正常或异常终止。</p>
<p>会话层很少说协议什么的，下面的介绍主要是 AI
生成我纠正的，大概了解即可。</p>
<h3 id="会话的建立">会话的建立</h3>
<p>当两个系统需要进行通信时，会话层会协商会话的参数，如会话的类型（单工、半双工或全双工）、会话的优先级等。例如，在一个视频会议系统中，会话层会建立一个<strong>全双工</strong>的会话，以确保参会者可以同时进行音频和视频的发送和接收。</p>
<p>而数据的来回传输都是通过 TCP 协议进行的。</p>
<h3 id="会话管理">会话管理</h3>
<p>在会话进行过程中，会话层会监控会话的状态。如果出现网络故障或者数据传输错误等情况，会话层会采取相应的措施来恢复会话。例如，当网络出现短暂的中断后，会话层可以重新建立连接，使会话能够继续进行。同时，它还可以对会话中的数据传输进行流量控制，防止数据发送过快导致接收方处理不过来。</p>
<h3 id="会话终止">会话终止</h3>
<p>会话层负责正常地关闭会话连接。当通信双方完成数据交换后，会话层会按照一定的协议来终止会话，确保双方的资源得到正确释放。例如，在文件传输完成后，会话层会发送一个会话终止请求，得到对方确认后，关闭会话连接。</p>
<h3 id="会话层与传输层的区别">会话层与传输层的区别</h3>
<p>传输层的 TCP
协议和会话层都是<strong>可靠传输</strong>，但是它们有一定区别。</p>
<p>TCP
的传输是<strong>单向的，一次性的</strong>，会话层这块就是<strong>完整的，双向的</strong>交流。</p>
<h2 id="表示层">表示层</h2>
<p>表示层的存在感挺弱的，这里不讲。</p>
<h2 id="应用层">应用层</h2>
<p>应用层是 OSI
模型的最高层，是用户与网络之间的直接接口。它主要负责为用户提供应用程序服务，包括电子邮件、文件传输、远程登录、Web
浏览等常见网络应用。应用层协议为应用程序提供访问网络的手段，使得用户可以在不同计算机之间进行各种形式的通信。</p>
<h3 id="dns-协议">DNS 协议</h3>
<p>DNS 协议中文名为 "域名服务协议"，用于将域名（例如
<code>www.huanyp.cn</code>）转换为 IP 地址。</p>
<p><em>DNS 服务器也在 IPV4 的配置里。</em></p>
<h4 id="工作过程">工作过程</h4>
<ol type="1">
<li><p><strong>用户设备向本地 DNS 发起查询</strong></p>
<p>当用户在浏览器输入网址等需要解析域名时，请求发送到本地
DNS。例如，你输入 “<a
target="_blank" rel="noopener" href="http://www.example.xn--com,-ib7ay197annxa/">www.example.com”，本地</a>
DNS 会先检查自己的缓存。如果缓存中有这个域名对应的 IP
地址记录，它会直接返回 IP 地址给用户设备。</p></li>
<li><p><strong>本地 DNS 向上级 DNS 或根 DNS
查询（如果需要）</strong></p>
<ul>
<li>如果本地 DNS 缓存中没有该域名的记录，它会向上级 DNS
发起查询。每个本地 DNS 服务器通常都有一个包含上级 DNS
地址的配置文件。这些上级 DNS 通常是服务提供商（如 ISP）的 DNS
服务器。</li>
<li>但是，当上级 DNS
也不能提供所需域名的解析结果时，最终的查找路径会到达根 DNS。根 DNS
是全球 DNS 层次结构的最顶级，负责维护顶级域名服务器（如 .com、.net
等顶级域名服务器）的地址信息。</li>
</ul></li>
<li><p><strong>层层查询直到解析完成</strong></p>
<ul>
<li>根 DNS 会告诉本地 DNS
<strong>哪个顶级域名服务器负责管理目标域名的顶级部分</strong>。例如，对于
“<a
target="_blank" rel="noopener" href="http://www.example.xn--com,-ib7aq929b/">www.example.com”，根</a>
DNS 可能会指向管理 “.com” 域名的顶级域名服务器。</li>
<li>然后本地 DNS
会联系这个顶级域名服务器，顶级域名服务器会进一步告诉本地 DNS
哪台权威域名服务器（通常是域名注册商或专业的 DNS 服务提供商）拥有
“example.com” 的详细信息。</li>
<li>最终，本地 DNS 会直接联系到权威域名服务器，获取 “<a
target="_blank" rel="noopener" href="http://www.example.xn--com-9o0a/">www.example.com”</a> 对应的准确
IP 地址，并将结果缓存下来，以便下次快速响应同类请求。</li>
</ul></li>
</ol>
<h3 id="http-协议">HTTP 协议</h3>
<p>HTTP 协议主要用于客户端与服务器通信，它的默认端口号是 80。</p>
<p>DNS 解析是<strong>不管端口</strong>的，如果你没有显示的在 IP/域名
后面指定端口，HTTP 会使用 80 端口和服务器程序通信。</p>
<h4 id="主要功能">主要功能</h4>
<ul>
<li>HTTP 是一种请求 - 响应协议。客户端（通常是浏览器）向服务器发送一个
HTTP
请求，请求的内容可以是一个网页、一张图片、一段视频等资源。例如，当你在浏览器中输入一个网址（如<a
target="_blank" rel="noopener" href="http://www.example.com/">http://www.example.com</a>）并访问时，浏览器就会作为
HTTP 客户端向服务器发送请求。</li>
<li>服务器在接收到请求后，会根据请求的内容进行处理，然后返回一个 HTTP
响应。这个响应包含了请求资源本身（如 HTML
文件、图像数据等），还有一些状态信息，如状态码。常见的状态码有
200（请求成功），表示服务器成功地处理了请求并返回了请求的资源；404（未找到），表示服务器找不到请求的资源。</li>
</ul>
<h4 id="协议特点">协议特点</h4>
<ol type="1">
<li><p><strong>简单快速</strong></p>
<p>HTTP 协议的语法相对简单，它基于 TCP/IP
协议，使用明文传输数据。客户端和服务器之间的通信过程比较直接，不需要复杂的握手过程（与
SSL/TLS 协议等相比）。这使得 HTTP
协议能够快速地建立连接并传输数据，从而提高了网页浏览等操作的效率。</p></li>
<li><p><strong>无状态性</strong></p>
<p>HTTP
协议本身是无状态的，也就是说，服务器不会记录客户端的状态。每次客户端请求和服务器响应都是独立的，服务器不会记住上一次客户端请求的内容。例如，当你访问一个电商网站的多个页面时，服务器不会自动记住你在上一个页面的操作（如添加商品到购物车），除非通过其他技术（如
Cookie 或者服务器端的会话存储）来保存状态信息。</p></li>
<li><p><strong>灵活</strong></p>
<p>HTTP 协议支持多种类型的请求方法，如
GET（用于获取资源）、POST（用于提交数据）、PUT（用于更新资源）、DELETE（用于删除资源）等。这使得
HTTP 协议可以满足不同的应用场景需求，无论是简单的网页浏览，还是复杂的
Web 应用程序的数据交互。</p></li>
</ol>
<h4 id="协议版本">协议版本</h4>
<ol type="1">
<li><p><strong>HTTP/1.0</strong></p>
<p>这是最早的广泛使用的版本。它比较简单，每次请求 -
响应完成后，连接就会关闭。如果客户端需要再次请求资源，就需要重新建立连接。这种方式在资源较少、网络带宽相对紧张的早期互联网环境中还可以，但在现代复杂的网络应用中就显得效率较低。</p></li>
<li><p><strong>HTTP/1.1</strong></p>
<p>HTTP/1.1 引入了持久连接（Persistent
Connection）的概念。在这种模式下，客户端和服务器之间的连接在一次请求 -
响应完成后不会立即关闭，可以被多个请求 -
响应过程共享。这样就减少了频繁建立和关闭连接所带来的开销，提高了传输效率。同时，HTTP/1.1
还增加了一些新的请求头和响应头字段，使得协议更加灵活和强大。</p></li>
<li><p><strong>HTTP/2</strong></p>
<p>HTTP/2 主要为了解决 HTTP/1.1
的一些性能瓶颈。它引入了多路复用（Multiplexing）技术，允许客户端和服务器同时发送多个请求和响应，而不需要等待前面的请求
- 响应过程完成。并且，HTTP/2
对数据进行了帧的划分和压缩等操作，进一步提高了数据传输的效率。这在现代的
Web
应用中，尤其是对于包含大量静态资源（如图片、脚本文件等）的网站，能够显著提高加载速度。</p></li>
</ol>
<h3 id="https-协议">HTTPS 协议</h3>
<p>HTTPS 协议本质是在 HTTP 协议的基础上加了一个 TLS/SSL
来保证传输过程的安全性，默认采用 443 端口。</p>
<h4 id="几个编程细节的提醒">几个编程细节的提醒</h4>
<ul>
<li>Python 的 <code>http.server</code> 不支持 HTTPS 协议，由于它没写
SSL/TLS
部分，所以在传输层就被扔包了，体现出来就是发了然后一点反应都没有，或者是单纯日志报一堆乱码但没有调用
handler。</li>
</ul>
<h3 id="tlsssl-协议">TLS/SSL 协议</h3>
<p>TLS/SSL 协议都是建立在 TCP
协议之上的，因此它们的通信本身是可靠的。</p>
<h4 id="证书链验证机制">证书链验证机制</h4>
<ul>
<li><strong>证书颁发机构（CA）验证</strong>：服务器会向客户端提供 SSL
证书，客户端需要验证 SSL
证书是否有效，同时要验证<strong>颁发机构</strong>是否可信。这通常通过检查证书链来实现，证书链从服务器的
SSL
证书开始，经过一系列中间证书，最终到达客户端信任的根证书。如果根证书是可信的，并且证书链中的每个证书都是有效的，那么客户端就可以信任服务器的SSL证书。</li>
<li><strong>证书信息验证</strong>：客户端会检查 SSL
证书中的信息，如域名、有效期、公钥等，是否与实际情况相符。例如，证书中的域名应该与用户正在访问的网站域名完全匹配。<strong>证书有效性</strong>验证涉及
RSA 的签名机制，在数学上可以确保安全。</li>
</ul>
<h4 id="ssl-握手过程">SSL 握手过程</h4>
<ul>
<li><strong>客户端发起连接</strong>：客户端（如浏览器）通过发送一个 "SH"
消息开始 SSL/TLS 握手过程。这个消息包含了客户端支持的 SSL/TLS
版本、加密套件（cs）、随机数（CR）和会话 ID。</li>
<li><strong>服务器响应</strong>：服务器收到 "ClientHello"
消息后，响应一个 "SH"
消息，选择一个双方都支持的加密套件和协议版本，并发送服务器随机数（SR）。</li>
<li><strong>证书传输</strong>：服务器发送其 SSL
证书给客户端。这个证书包含了服务器的公钥，以及由证书颁发机构（CA）签发的证书信息。</li>
<li><strong>证书验证</strong>：客户端验证服务器证书的有效性，包括证书是否过期、是否被撤销、证书链是否完整，以及证书的域名是否与服务器域名匹配。</li>
<li><strong>密钥交换</strong>：如果使用 RSA
密钥交换算法，客户端会生成一个临时的会话密钥（PMS），并使用服务器的公钥加密这个密钥，然后发送给服务器。服务器使用自己的私钥解密得到会话密钥。</li>
<li><strong>握手结束</strong>：客户端和服务器使用会话密钥生成最终的加密密钥，并使用这个密钥加密后续通信。客户端发送
"Finished" 消息，包含握手消息的哈希值，服务器也发送 "Finished"
消息，确认握手成功。</li>
</ul>
<h4 id="tls-协议">TLS 协议</h4>
<p>上面说的 SSL 协议本身是没有漏洞的，但是 SSL 的实现中为了效率采用了
Padding Oracle 机制，因此衍生出一种叫做 POODLE（降级加密密文填充攻击）
的 MiTMA（中间人攻击）。</p>
<p>TLS 解决了这个问题，其它和 SSL 差别不大。</p>
<h2 id="提醒">提醒</h2>
<p>看完本文后，你应该有了一些基础的网络知识。</p>
<p>笔者必须提醒你，这些知识是<strong>危险</strong>的。</p>
<p>人类第一次仰望星空时，就已经具备了进行星际航行的能力；你了解这些知识后，与黑客技术也只剩下一层窗户纸了。</p>
<p><strong>记住，知识是中立的，你应该用你的道德，去掌控你所拥有的知识。</strong></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag"># 网络</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/02/15/todo/" rel="prev" title="Todo">
                  <i class="fa fa-angle-left"></i> Todo
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/02/20/%E5%AD%A6%E6%9C%AF/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="next" title="神经网络学习笔记">
                  神经网络学习笔记 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">huan-yp</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
