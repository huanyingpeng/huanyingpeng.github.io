<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"huanyp.cn","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","display":"post","width_expanded":320,"width_dual_column":240,"padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="题解合集1 懒得分开写咕咕咕 ARC153D 考虑 A 比较小的时候应该怎么做，记 \(dp[i][a]\) 表示考虑低 \(i\) 位，填的数字是 \(a\)，低 \(i\) 位的贡献。 转移枚举下一位填什么，计算答案的方式是统计当前位上每个数字各有多少个。因为有进位所以这还比较麻烦 如果从小到大枚举 \(a\)，那么进位的计算是容易的，维护一个 \(cnt\) 数组即可，按低 \(i">
<meta property="og:type" content="article">
<meta property="og:title" content="部分题解合集">
<meta property="og:url" content="https://huanyp.cn/2023/01/31/OI/%E9%A2%98%E8%A7%A3%E5%90%88%E9%9B%86/%E5%81%9A%E9%A2%984/index.html">
<meta property="og:site_name" content="幻影彭的彩虹">
<meta property="og:description" content="题解合集1 懒得分开写咕咕咕 ARC153D 考虑 A 比较小的时候应该怎么做，记 \(dp[i][a]\) 表示考虑低 \(i\) 位，填的数字是 \(a\)，低 \(i\) 位的贡献。 转移枚举下一位填什么，计算答案的方式是统计当前位上每个数字各有多少个。因为有进位所以这还比较麻烦 如果从小到大枚举 \(a\)，那么进位的计算是容易的，维护一个 \(cnt\) 数组即可，按低 \(i">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-01-31T12:10:31.000Z">
<meta property="article:modified_time" content="2025-02-16T09:58:27.240Z">
<meta property="article:author" content="huan-yp">
<meta property="article:tag" content="题解">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://huanyp.cn/2023/01/31/OI/%E9%A2%98%E8%A7%A3%E5%90%88%E9%9B%86/%E5%81%9A%E9%A2%984/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://huanyp.cn/2023/01/31/OI/%E9%A2%98%E8%A7%A3%E5%90%88%E9%9B%86/%E5%81%9A%E9%A2%984/","path":"2023/01/31/OI/题解合集/做题4/","title":"部分题解合集"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>部分题解合集 | 幻影彭的彩虹</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">幻影彭的彩虹</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记录青春的扇区</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-友情链接"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友情链接</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3%E5%90%88%E9%9B%861"><span class="nav-number">1.</span> <span class="nav-text">题解合集1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#arc153d"><span class="nav-number">1.1.</span> <span class="nav-text">ARC153D</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#arc154d"><span class="nav-number">1.2.</span> <span class="nav-text">ARC154D</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#p5156"><span class="nav-number">1.3.</span> <span class="nav-text">P5156</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#p4187"><span class="nav-number">1.4.</span> <span class="nav-text">P4187</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#p7152"><span class="nav-number">1.5.</span> <span class="nav-text">P7152</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#p6142"><span class="nav-number">1.6.</span> <span class="nav-text">P6142</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#p8194"><span class="nav-number">1.7.</span> <span class="nav-text">P8194</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#tricks"><span class="nav-number">1.7.1.</span> <span class="nav-text">Tricks</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#p4649"><span class="nav-number">1.8.</span> <span class="nav-text">P4649</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%99%E8%AE%AD"><span class="nav-number">1.8.1.</span> <span class="nav-text">教训</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#p8290"><span class="nav-number">1.9.</span> <span class="nav-text">P8290</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#p4233"><span class="nav-number">1.10.</span> <span class="nav-text">P4233</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cf798d"><span class="nav-number">1.11.</span> <span class="nav-text">CF798D</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="huan-yp"
      src="https://cdn.luogu.com.cn/upload/image_hosting/kvac64s4.png">
  <p class="site-author-name" itemprop="name">huan-yp</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">108</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">49</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/huan-yp" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;huan-yp" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:3051561876@qq.com" title="E-Mail → mailto:3051561876@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/1155409006?spm_id_from=333.1369.0.0" title="Bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;1155409006?spm_id_from&#x3D;333.1369.0.0" rel="noopener me" target="_blank"><i class="fab fa-youtube fa-fw"></i>Bilibili</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://huanyp.cn/2023/01/31/OI/%E9%A2%98%E8%A7%A3%E5%90%88%E9%9B%86/%E5%81%9A%E9%A2%984/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/image_hosting/kvac64s4.png">
      <meta itemprop="name" content="huan-yp">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="幻影彭的彩虹">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="部分题解合集 | 幻影彭的彩虹">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          部分题解合集
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-01-31 20:10:31" itemprop="dateCreated datePublished" datetime="2023-01-31T20:10:31+08:00">2023-01-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-02-16 17:58:27" itemprop="dateModified" datetime="2025-02-16T17:58:27+08:00">2025-02-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/" itemprop="url" rel="index"><span itemprop="name">算法竞赛</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="题解合集1">题解合集1</h2>
<p>懒得分开写咕咕咕</p>
<h3 id="arc153d">ARC153D</h3>
<p>考虑 A 比较小的时候应该怎么做，记 <span
class="math inline">\(dp[i][a]\)</span> 表示考虑低 <span
class="math inline">\(i\)</span> 位，填的数字是 <span
class="math inline">\(a\)</span>，低 <span
class="math inline">\(i\)</span> 位的贡献。</p>
<p>转移枚举下一位填什么，计算答案的方式是统计当前位上每个数字各有多少个。因为有进位所以这还比较麻烦</p>
<p>如果从小到大枚举 <span
class="math inline">\(a\)</span>，那么进位的计算是容易的，维护一个 <span
class="math inline">\(cnt\)</span> 数组即可，按低 <span
class="math inline">\(i\)</span> 位排序后双指针即可。</p>
<p>我们可以以 <span class="math inline">\(O(A)\)</span>
的复杂度计算答案。</p>
<p>事实上我们发现我们并不需要记录所有的 <span
class="math inline">\(a\)</span>，对于进位状况相同的 <span
class="math inline">\(a\)</span>，我们只需要它的最小值，而进位状况是
<span class="math inline">\(O(2\times10^5)\)</span> 级别的，改变状态，记
<span class="math inline">\(dp[i][j]\)</span> 表示考虑低 <span
class="math inline">\(i\)</span> 位，一共有 <span
class="math inline">\(j\)</span> 个数进位，只考虑低 <span
class="math inline">\(i\)</span> 位时答案的最小值。</p>
<p>显然只会是低 <span class="math inline">\(i\)</span> 位最小的 <span
class="math inline">\(j\)</span> 个数进位，答案计算式类似的。</p>
<p><strong>这道题的优化本质上是分析了转移所需信息，利用问题的最优子结构性质，构造出了更加精简的状态。</strong></p>
<h3 id="arc154d">ARC154D</h3>
<p><span class="math inline">\(1\)</span> 是比较特殊的数，如果找到了
<span class="math inline">\(1\)</span>，设它的位置为 <span
class="math inline">\(v\)</span>，我们就可以在 <span
class="math inline">\(O(n\log n)\)</span>
的时间内对其它数排好序，具体的，考虑构造一个下标序列 <span
class="math inline">\(a\)</span>，使得 <span
class="math inline">\(p_{a_i}=i\)</span>，以插入的方式来构造。二分下一个元素
<span class="math inline">\(x\)</span> 插入的位置 <span
class="math inline">\(i\)</span>，询问 <span
class="math inline">\((v,a_i,x)\)</span>，如果答案为 Yes，那么 <span
class="math inline">\(x\)</span> 应该插入在 <span
class="math inline">\(a_i\)</span> 左边，否则为右边。</p>
<p>怎么找 <span class="math inline">\(1\)</span>，对于 <span
class="math inline">\(1\)</span>，询问 自身+自身&gt;其它数
都是不成立的，有一个比较容易的 <span class="math inline">\(n^2\)</span>
方式。考虑到对于 <span class="math inline">\([1,n]\)</span>
中的任意一个数，有一半的数在询问 自身+自身&gt;某个其它的数 的结果都是
Yes，因此可以排除一半的数，且留下来的数仍然是 <span
class="math inline">\([k,n]\)</span>
的形式，注意那个其它的数需要拿出来。做 <span class="math inline">\(\log
n\)</span> 次拿出 <span class="math inline">\(\log n\)</span> 个数，以
<span class="math inline">\(\log^2n\)</span>
的复杂度检查剩下的数即可，总复杂度 <span class="math inline">\(O(n\log n
+ n +\log^2 n)\)</span></p>
<h3 id="p5156">P5156</h3>
<p>考虑一个逆序对，它会消失当且仅当某个端点被选择，所以排好序的必要条件是对于所有的逆序对，至少需要选择两个端点中的一个，这个条件也是充分的，因为只要存在逆序对就会被交换。</p>
<p>一种思路是设 <span class="math inline">\(dp[i][j]\)</span> 表示考虑前
<span class="math inline">\(i\)</span> 个元素，没有被选择的最大的元素是
<span class="math inline">\(j\)</span>，且前 <span
class="math inline">\(i\)</span>
个元素均合法的最小子集大小。考虑转移，一个元素 <span
class="math inline">\(a_i\)</span> 选当然没有问题，不选当且仅当 <span
class="math inline">\(a_i&gt;j\)</span>，否则存在一个两端都没被选的逆序对。</p>
<p>然后把转移图画出来发现不选的元素就是个
LIS，实际上想的时候还想了线段树去优化原式的转移emmm。</p>
<p><strong>从子集的补集逆向考虑，容易发现它们之间不存在逆序对，因此子集的补集是单调的。</strong></p>
<p>因此问题变成了求第字典序 <span class="math inline">\(K\)</span> 大的
LIS，很简单了。</p>
<h3 id="p4187">P4187</h3>
<p>考虑一种结果能被构造的充要条件——存在一段长度为 <span
class="math inline">\(k\)</span> 的颜色相同子段。</p>
<p>必要性显然，充分性考虑用构造法证明，具体的，记 <span
class="math inline">\(a_i\)</span> 表示 <span
class="math inline">\(i\)</span> 的颜色，颜色相同的子段为 <span
class="math inline">\([l,l+k)\)</span>。记 <span
class="math inline">\(P(c,l)\)</span> 表示用 <span
class="math inline">\(c\)</span> 颜色涂区间 <span
class="math inline">\([l,l+k)\)</span>。依次进行如下操作： <span
class="math inline">\(P(a_1,1),P(a_2,2)\cdots
P(l-1,a_{l-1}),P(n-k+1,a_n),P(n-k,a_{n-1})\cdots
P(l+1,a_{l+k}),P(l,a_{l})\)</span>。</p>
<p>枚举第一个长度为 <span class="math inline">\(k\)</span>
的区间的左端点 <span class="math inline">\(i\)</span>，记 <span
class="math inline">\([1,i]\)</span> <strong>不出现连续长度为 <span
class="math inline">\(k\)</span>
的子串，且最后一个位置不能和下一个位置相同的涂色方案数</strong>为 <span
class="math inline">\(g_i\)</span></p>
<p>则总方案数为 <span
class="math inline">\(\sum\limits_{i=k}^nm^{n-k+1}g_{i-1}\)</span></p>
<p>考虑 <span class="math inline">\(g_i\)</span>
的转移，不妨枚举最后一个位置的连续长度，得到 <span
class="math inline">\(g_i=(m-1)\sum\limits_{j=\max(0,i-k+1)}g_j\)</span>。</p>
<p>简单前缀和。</p>
<p><strong>为什么是 <span
class="math inline">\(m-1\)</span>：钦定了最后一个位置不能和下一个位置相同。</strong></p>
<p>另一种思考方式是考虑统计不合法的方案总数，答案就是 <span
class="math inline">\(m^n-f_i\)</span>。其中 <span
class="math inline">\(f_i\)</span> 表示长度为 <span
class="math inline">\(i\)</span> 的段，不出现连续长度为 <span
class="math inline">\(k\)</span> 的子串的方案数，对于 <span
class="math inline">\(i&lt;k,f_i=m^i\)</span>，否则转移和 <span
class="math inline">\(g\)</span> 相同。</p>
<h3 id="p7152">P7152</h3>
<p>考虑对生成后的串 DP，设 <span class="math inline">\(dp[i][c]\)</span>
表示考虑到生成后的串的前 <span class="math inline">\(i\)</span> 个，在
<span class="math inline">\(i\)</span> 处和 <span
class="math inline">\(i+1\)</span> 处被分开了，<strong><span
class="math inline">\(i\)</span> 所属的段开头(原串结尾)为 <span
class="math inline">\(c\)</span> 的方案总数。</strong></p>
<p><strong>以下的串无特别说明均指被生成的串，也就是输入的那个串</strong>。</p>
<p><span class="math inline">\(dp[i]\)</span> 的转移枚举起始位置 <span
class="math inline">\(j\)</span> 以及对应的 <span
class="math inline">\(j\)</span> 所属的段的开头字符 <span
class="math inline">\(c_1\)</span>，以及 <span
class="math inline">\(j+1,i\)</span> 位置的取值 <span
class="math inline">\(c_2,c_3\)</span>，转移的要求是 <span
class="math inline">\(c_1=c_3\)</span>，<span
class="math inline">\(dp[i]\)</span> 的第二维下标是 <span
class="math inline">\(c_2\)</span>，转移的额外系数也是容易计算的，不妨设它为
<span class="math inline">\(w(j+1,i,c_2,c_3)\)</span>，一次转移就是
<span class="math inline">\(dp[j][c_1]\times
w(j+1,i,c_2,c_3)\)</span>，由于 <span
class="math inline">\(c_1,c_2,c_3\)</span>
的取值都是常数种，我们干脆将它们视作一个参数 <span
class="math inline">\(c\)</span>，得到转移结果为 <span
class="math inline">\(b(j,i,c)\)</span>。</p>
<p>因为 <span class="math inline">\(\sum\limits_j b(j,i,c)\)</span> 对
<span class="math inline">\(i\)</span>
有比较好的转移性质，所以考虑维护所有 <span
class="math inline">\(c\)</span> 的 <span
class="math inline">\(B_c(i)=\sum\limits_{j} b(j,i,c)\)</span></p>
<p>不难发现 <span class="math inline">\(b(j,i+1,c)=\sum\limits_{c_0}
k_{c_0}b(j,i,c_0)\)</span>，将这个转移带进 <span
class="math inline">\(B_c(i)\)</span> 里去，得到 <span
class="math inline">\(B_c(i+1)=\sum\limits_{c_0}k_{c_0}B_{c_0}(i)\)</span>。</p>
<p>能够计算 <span class="math inline">\(B_c(i)\)</span> 了，那么 <span
class="math inline">\(dp[i]\)</span> 的计算也就容易了，注意对于 <span
class="math inline">\(B_c(i+1)\)</span> 需要补上 <span
class="math inline">\(dp[i]\)</span> 的贡献。</p>
<p>另一种思考方式是套路的考虑将<strong>下一个字符并入上一段或者新开一段</strong>，复杂度一样的，其实本质也是一样的。</p>
<h3 id="p6142">P6142</h3>
<p>最小值最大二分，然后一棵子树，传上去的长度自然越大越好，设 <span
class="math inline">\(dp_u\)</span> 表示 <span
class="math inline">\(u\)</span> 子树满足 <span
class="math inline">\(k\)</span>
限制的前提下传上去的最大的数是多少，然后问题变成了对于若干个数，需要选一个或两个数配对，满足和不小于
<span class="math inline">\(k\)</span>，且剩下的最大（不剩下就是 <span
class="math inline">\(0\)</span>）。</p>
<p>讨论两种情况</p>
<ul>
<li>不剩下</li>
<li>剩下一个</li>
</ul>
<p>显然剩下的这个数的大小有单调性可以二分，变成不剩下的情况，现在考虑怎么
check
不剩下的情况，偶数个直接最大最小，次大次小配对最优，奇数个必须先拿一个最小的不小于
<span class="math inline">\(k\)</span> 的，再如上配对。</p>
<p>复杂度 <span class="math inline">\(O(n\log^2n)\)</span>。</p>
<h3 id="p8194">P8194</h3>
<p>发现没有 <span class="math inline">\(5\)</span> 的情况是好做的，设
<span class="math inline">\(dp[i]\)</span> 表示考虑前 <span
class="math inline">\(i\)</span> 个数字的答案，当某两个可以一起按时
<span class="math inline">\(dp[i]=dp[i-1]+dp[i-2]\)</span>，否则 <span
class="math inline">\(dp[i]=dp[i-1]\)</span>。</p>
<p>对于可以一起按的情况，分按和不按两种情况，不按的方案数是 <span
class="math inline">\(dp[i-1]\)</span>，按的方案数是 <span
class="math inline">\(dp[i-2]*2\)</span>，但是由于如果是顺序的，按的情况和不按的情况恰好有
<span class="math inline">\(dp[i-2]\)</span>
中是冲突的（按也能取到这种方案，不按也可以）。减掉即可。</p>
<p>考虑存在同时按四个的情况，这是一件很麻烦的事情，要容斥掉按四个和不按的冲突非常的困难。</p>
<p>不会了，换个角度思考。</p>
<p>考虑判定问题，即给定 <span class="math inline">\(T\)</span>
判断是否能生成 <span class="math inline">\(S\)</span>，记 <span
class="math inline">\(ok[i]\)</span> 表示只考虑前 <span
class="math inline">\(i\)</span> 位能否生成，转移可以从 <span
class="math inline">\(i-1,i-2,i-4\)</span> 转移过来。</p>
<p><strong>考虑对判定过程 dp</strong>，记录前 <span
class="math inline">\(3\)</span>
个位置的具体值，枚举下一个位置的具体值尝试转移，发现还需要记录前 <span
class="math inline">\(4\)</span> 个位置判定 dp 的值，<strong>发现这样的
dp 恰好是不重不漏的</strong>，因为状态中三个具体值不同的显然本质不同，而
dp
值不同的显然也本质不同，所以<strong>同一阶段不同状态不重不漏</strong>，因此整个
dp 不重不漏。</p>
<p>总复杂度是 <span
class="math inline">\(O(n\times9^4\times2^4)\)</span>，跑不动，考虑常数优化。</p>
<p>记录三个位置的具体值很浪费，实际上大部分组合都用不到。</p>
<p>如果四个位置 dp 值全是 <span class="math inline">\(0\)</span>
这个状态直接扔掉。如果当最靠前的一个位置的 dp 值为 <span
class="math inline">\(0\)</span>，那么最后一个数是没有用的，可以压进一个状态里。如果记录的最后三个数不是接下来四个数排列，那么可以认为最后一个位置的
dp 值为 <span class="math inline">\(0\)</span>，所以按最后一个位置 dp
值分类，我们的状态数变为了 <span class="math inline">\(8\times
24+8\times 99\)</span>。同理对倒数第二个位置的 dp
值再分类讨论可以进一步压缩状态，状态数应该是可以压缩进 <span
class="math inline">\(200\)</span> 以内的。</p>
<h4 id="tricks">Tricks</h4>
<ul>
<li>对于部分序列计数问题，<strong>可以考虑对判定过程动态规划</strong>，由于转移所需的序列值不同或者判定的动态规划值不同的状态时本质不同的，所以这样的动态规划是不重不漏的。</li>
<li>上述动态规划的优化可以通过减小状态空间完成，主要方式是分析判定问题本身的性质以排除不可能对答案产生贡献的状态。</li>
</ul>
<h3 id="p4649">P4649</h3>
<p>首先有一个很重要的观察，覆盖奇数条树边的非树边一定要选。</p>
<p>对于覆盖偶数条树边的，如果任意两条非树边覆盖的边集有交，那么一定可以构造出一种合法的路径（参考欧拉子图计数问题）。</p>
<p>因此问题变成选树上若干条无交的路径使得权值和最大。考虑动态规划。</p>
<p>设 <span class="math inline">\(dp[u]\)</span> 表示只考虑 <span
class="math inline">\(u\)</span> 的子树里的路径，<span
class="math inline">\(u\)</span>
子树内能选出的权值最大值，发现转移是不好做的，于是多记一维 <span
class="math inline">\(dp[u][k]\)</span> 表示考虑 <span
class="math inline">\(u\)</span> 子树，<span
class="math inline">\(u\)</span> 连出了编号为 <span
class="math inline">\(k\)</span> 的路径的权值最大值，<strong>先不计算
<span class="math inline">\(k\)</span> 的贡献</strong>，并要求 <span
class="math inline">\(k\)</span> 的一个端点一定在 <span
class="math inline">\(u\)</span> 子树内。</p>
<p>转移的时候就是儿子间两两配对，如果知道了儿子配对的方式，那么我们只需要贪心的让每一个配对取最大值转移，当然儿子也可以不配对或者和父亲配对，我们将不配归类到和父亲配对。</p>
<p>发现儿子配对的方式可以直接枚举，计算答案时需要一个 <span
class="math inline">\(mp[v_1][v_2]\)</span> 表示 <span
class="math inline">\(v_1,v_2\)</span> 儿子配对的最大值，可以枚举 lca
挂在这个点上的每条边统计。</p>
<p>实际上 dfs 枚举配对方式不是必要的，可以状压 dp，更好写。</p>
<h4 id="教训">教训</h4>
<ul>
<li>vector 用 lower_bound 删点的时候<strong>要先排好序</strong>。</li>
<li>dfs 枚举配对的循环里<strong>不要忘记判掉已经配好对的</strong>。</li>
</ul>
<h3 id="p8290">P8290</h3>
<p>极差问题考虑枚举一下最大值位置，然后发现答案是关于最大值 <span
class="math inline">\(x\)</span> 的一个 <span
class="math inline">\(n\)</span> 次多项式。但是需要去重，很麻烦。</p>
<p>对于这种需要满足至少一个取到边界的问题，或者说与最值有关的计数问题，可以考虑容斥，<strong>用不限制取到闭区间的方案数，减去一定不满足的方案数——取到开区间的方案数</strong>，得到一定取到闭区间的方案数。</p>
<p>或者说正难则反，考虑总方案减去不合法方案数。</p>
<h3 id="p4233">P4233</h3>
<p>竞赛图有一个重要结论：缩点后一定是一条链状的
DAG，每个点向后面所有点有连边。</p>
<p>考虑到求总的哈密顿回路是容易的：枚举一条回路，其它边任意定向。我们考虑求出存在哈密顿回路的竞赛图个数。</p>
<h3 id="cf798d">CF798D</h3>
<p>先考虑了每个数和中位数、平均数的大小关系来决定是否选择。然后想能不能构造
<span class="math inline">\(c=a+b\)</span> 在 <span
class="math inline">\(c\)</span>
上先贪心选择然后再调整让不满足条件的那个数组满足条件。都失败了。</p>
<p><strong>两个数组都是无序的不好考虑</strong>，将 <span
class="math inline">\(a\)</span> 降序排列。考虑钦定 <span
class="math inline">\(b\)</span> 满足条件并尽可能使 <span
class="math inline">\(a\)</span> 满足条件。如果 <span
class="math inline">\(n\)</span> 为奇数，我们可以选择 <span
class="math inline">\(a_1\)</span>，然后将后面的两两分组。每一组选择
<span class="math inline">\(b\)</span> 较大的那一个，这样 <span
class="math inline">\(b\)</span> 一定满足条件。然后又因为我们选了 <span
class="math inline">\(a_1\)</span>，<span
class="math inline">\(a_1\)</span> 和第一组配对，第一组的 <span
class="math inline">\(a\)</span> 和第二组的 <span
class="math inline">\(a\)</span> 配对，然后 <span
class="math inline">\(a\)</span> 也满足条件。</p>
<p>偶数同理。</p>
<p>构造完了，这种贪心<strong>按对决策</strong>的思路很有学习价值，题目中的选一半也提示了这种方式。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag"># 题解</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/01/31/OI/%E6%AF%94%E8%B5%9B/CF1787/" rel="prev" title="CF1787">
                  <i class="fa fa-angle-left"></i> CF1787
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/02/01/OI/%E8%80%83%E8%AF%95%E6%80%BB%E7%BB%93/2023/0201%E6%B5%8B%E8%AF%95/" rel="next" title="0201测试">
                  0201测试 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">huan-yp</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
